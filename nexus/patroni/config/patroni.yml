# Patroni configuration file generated from template /docker/nexus/patroni/config/patroni-template.yml
# Date: Thu  4 Dec 23:23:53 GMT 2025


scope: luxforge_crafted_nexus
namespace: /patroni/
name: kemel-patroni 

log:
  format: "%(asctime)s %(levelname)s: %(message)s"
  
  level: DEBUG
  max_queue_size: 1000
  traceback_level: DEBUG
  type: plain

restapi:
  listen: 0.0.0.0:8008
  connect_address: 10.10.37.10:2379 

etcd3:
  hosts:
    - 10.10.33.2 
    - 10.10.34.2 
    - 10.10.35.2 
    - 10.10.36.2 
    - 10.10.37.2 

bootstrap:
  dcs:
    ttl: 30
    loop_wait: 10
    retry_timeout: 10
    maximum_lag_on_failover: 1048576
  postgresql:
    use_pg_rewind: true
    parameters:
      max_connections: 100
      max_worker_processes: 8
      max_locks_per_transaction: 64
      password_encryption: 'scram-sha-256'
  initdb:
    - encoding: UTF8
    - data-checksums
  users:
    admin:
      password: "PFna4qy4v0tnVrgU1FvCmVPJ4HNLwAiLe6JpbbLKm3XSPfnGCZADk4UuzECEXdJq"
      options:
        - createrole
        - createdb

postgresql:
  listen: 0.0.0.0:5432
  connect_address: 10.10.37.10:5433 
  data_dir: /var/lib/postgresql/data
  bin_dir: /usr/local/bin
  pgpass: /tmp/pgpass
  pg_hba:
    - host replication "luxforge_replicator"  10.10.33.10 
    - host replication "luxforge_replicator"  10.10.34.10 
    - host replication "luxforge_replicator"  10.10.35.10 
    - host replication "luxforge_replicator"  10.10.36.10 
    - host replication "luxforge_replicator"  10.10.37.10 
    
    - host all "luxforge_su" 10.10.33.10 
    - host all "luxforge_su" 10.10.34.10 
    - host all "luxforge_su" 10.10.35.10 
    - host all "luxforge_su" 10.10.36.10 
    - host all "luxforge_su" 10.10.37.10 

  authentication:
    replication:
      username: "luxforge_replicator"
      password: "WNS8xFvgB0b5E9m5cbCxiBSQgJt3CJMw6eQPoeQG8vglVWcSkJabEcrp548DfnR2"
    superuser:
      username: "luxforge_su"
      password: "hKYgLGleOQEuGUVyUQ0uepbejwailJg2iTP7X8LTGM7t1J5hY6yZ6tngO14VoPvK"
  tags:
    nofailover: false
    noloadbalance: false
    clonefrom: false
    nosync: false

watchdog:
  mode: "off"
  device: /dev/watchdog
  safety_margin: 5
